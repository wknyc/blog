function mappCheckAPI(){var d=document.getElementById("api_key");var a=document.getElementById("api_message");var c=document.getElementById("api_block");var b='<a target="_blank" href="http://code.google.com/apis/maps/signup.html">'+mappressl10n.here+"</a>";if(d.value==""){c.className="api_error";a.innerHTML=mappressl10n.api_missing+b;return}if(typeof GBrowserIsCompatible=="function"&&GBrowserIsCompatible()){return}c.className="api_error";a.innerHTML=mappressl10n.api_incompatible+b}jQuery(document).ready(function(){jQuery("#mapp_icon_list").dialog({title:mappressl10n.select_icon,"overflow-y":"auto",autoOpen:false,resizable:true,width:"50%",height:"auto"});jQuery("#mapp_icon_list").click(function(a){jQuery("#default_icon").val(a.target.id);jQuery("#icon_picker").attr("src",a.target.src);jQuery("#mapp_icon_list").dialog("close")});jQuery("#icon_picker").click(function(){jQuery("#mapp_icon_list").dialog("open")})});jQuery(document).ready(function(a){jQuery("#mapp_recenter").click(function(b){editMap.reCenter(null,true)});jQuery("#mapp_insert").click(function(b){mappInsertShortCode()});jQuery("#mapp_add_location").click(function(b){mappAddLocation()});jQuery('input[name="mapp_size"]').click(function(c){var b=jQuery('input[name="mapp_size"]:checked').val();editMap.reSize(b,jQuery("#mapp_width").val(),jQuery("#mapp_height").val());if(b=="CUSTOM"){jQuery("#mapp_width").attr("readonly",false);jQuery("#mapp_height").attr("readonly",false)}else{jQuery("#mapp_width").attr("readonly",true);jQuery("#mapp_height").attr("readonly",true)}});jQuery("#mapp_width").change(function(b){if(jQuery("#mapp_width").val()<=0){jQuery("#mapp_width").val(1)}if(jQuery("#mapp_width").val()>=2048){jQuery("#mapp_width").val(2048)}editMap.reSize(jQuery('input[name="mapp_size"]:checked').val(),jQuery("#mapp_width").val(),jQuery("#mapp_height").val())});jQuery("#mapp_height").change(function(b){if(jQuery("#mapp_height").val()<=0){jQuery("#mapp_height").val(1)}if(jQuery("#mapp_height").val()>=2048){jQuery("#mapp_height").val(2048)}editMap.reSize(jQuery('input[name="mapp_size"]:checked').val(),jQuery("#mapp_width").val(),jQuery("#mapp_height").val())})});function mappInsertShortCode(){shortcode="[mappress]";send_to_editor(shortcode);return false}function mappAddLocation(){var e=jQuery("#mapp_input_lat").val();var c=jQuery("#mapp_input_lng").val();var b=jQuery("#mapp_input_address").val();var d=jQuery("#mapp_message");d.text("");d.removeClass("updated fade error");if(e&&c){var a=new GLatLng(e,c);mappAddPOI(a,e+","+c,e+","+c)}else{if(b){mappGeocoder.getLocations(b,mappCheckGeocodedAddress)}else{d.text(mappressl10n.enter_location);d.removeClass("updated fade error");d.addClass("updated fade");return}}}function mappCheckGeocodedAddress(e){var d=jQuery("#mapp_input_address").val();var f=jQuery("#mapp_message");if(!e||e.Status.code!=200){f.text(mappressl10n.no_address);jQuery("#mapp_message").removeClass("updated fade error");f.addClass("error");return}var c=e.Placemark[0];var a=new GLatLng(c.Point.coordinates[1],c.Point.coordinates[0]);var g=c.ExtendedData;var b=g?g.LatLonBox:undefined;mappAddPOI(a,d,c.address,b)}function mappAddPOI(a,c,e,b){if(!a.lat()||!a.lng()){alert("Mappress internal error in geocoding!");return}var f={address:c,corrected_address:e,lat:a.lat(),lng:a.lng(),boundsbox:b,icon:""};var d=editMap.addPOI(f);jQuery("#mapp_input_address").val("");jQuery("#mapp_input_lat").val("");jQuery("#mapp_input_lng").val("")};